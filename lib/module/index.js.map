{"version":3,"sources":["index.tsx"],"names":["React","createRef","useEffect","useImperativeHandle","findNodeHandle","requireNativeComponent","UIManager","InViewPort","JWPLAYER_TAG","ImpresaJwplayerComponent","ImpresaJwplayerViewManager","props","ref","uiComponentRef","nativeCommands","getViewManagerConfig","Commands","sendCommand","command","localNativeCommand","undefined","playerNodeHandle","current","dispatchViewManagerCommand","play","pause","toggleFullScreen","destroy","playPauseWhenVisible","isVisible","file","WrapperJwPlayer","forwardRef","memo"],"mappings":"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","sourcesContent":["// @ts-nocheck\n\nimport React, { createRef, useEffect, useImperativeHandle } from 'react';\nimport {\n  findNodeHandle,\n  requireNativeComponent,\n  UIManager,\n  ViewStyle,\n} from 'react-native';\nimport InViewPort from './InViewPort';\n\ntype ImpresaJwplayerProps = {\n  licenseKey?: string;\n  file?: string;\n  style?: ViewStyle;\n  imageFile?: string;\n  volume?: number;\n  autostart?: boolean;\n  repeatVideo?: boolean;\n  controls?: boolean;\n  onFullScreen?: Function;\n  onFullScreenExit?: Function;\n  onPlay?: Function;\n  onPause?: Function;\n  ref?: any;\n  adSchedule?: Array<{ tag: String; offset: string }>;\n  mediaId?: string;\n  title?: string;\n  desc?: string;\n  playPauseWhenVisible?: boolean;\n};\n\nconst JWPLAYER_TAG = 'ImpresaJwplayerView';\nexport const ImpresaJwplayerComponent =\n  requireNativeComponent<ImpresaJwplayerProps>(JWPLAYER_TAG);\nfunction ImpresaJwplayerViewManager(props: ImpresaJwplayerProps, ref: any) {\n  const uiComponentRef = createRef();\n  const nativeCommands = UIManager.getViewManagerConfig(JWPLAYER_TAG).Commands;\n\n  const sendCommand = (command) => {\n    const localNativeCommand = nativeCommands[command];\n\n    if (localNativeCommand === undefined) {\n      return;\n    }\n    /* @ts-ignore */\n    const playerNodeHandle = findNodeHandle(uiComponentRef.current);\n    UIManager.dispatchViewManagerCommand(\n      playerNodeHandle,\n      localNativeCommand,\n      []\n    );\n  };\n\n  useImperativeHandle(ref, () => ({\n    play: () => {\n      sendCommand('play');\n    },\n    pause: () => {\n      sendCommand('pause');\n    },\n    toggleFullScreen: () => {\n      sendCommand('toggleFullScreen');\n    },\n    destroy: () => {\n      sendCommand('destroy');\n    },\n  }));\n\n  return (\n    <InViewPort\n      disabled={!props.playPauseWhenVisible}\n      onChange={(isVisible) => {\n        if (props.playPauseWhenVisible) {\n          isVisible ? sendCommand('play') : sendCommand('pause');\n        }\n      }}\n    >\n      <WrapperJwPlayer\n        key={props.file}\n        /* @ts-ignore */\n        ref={uiComponentRef}\n        onDestroy={() => {\n          sendCommand('destroy');\n        }}\n        {...props}\n      />\n    </InViewPort>\n  );\n}\n\nconst WrapperJwPlayer: React.FC<ImpresaJwplayerProps> = React.forwardRef(\n  (props, ref) => {\n    const nativeCommands =\n      UIManager.getViewManagerConfig(JWPLAYER_TAG).Commands;\n\n    useEffect(() => {\n      return () => {\n        /* @ts-ignore */\n        const { current } = ref;\n        if (current) {\n          const playerNodeHandle = findNodeHandle(current);\n          UIManager.dispatchViewManagerCommand(\n            playerNodeHandle,\n            nativeCommands.destroy,\n            []\n          );\n        }\n      };\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [ref]);\n    return <ImpresaJwplayerComponent {...props} ref={ref} />;\n  }\n);\n\nexport default React.memo(React.forwardRef(ImpresaJwplayerViewManager));\n"]}